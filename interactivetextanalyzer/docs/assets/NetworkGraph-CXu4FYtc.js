import{r as v,j as A}from"./index-BhwZeMYX.js";import{a4 as q,q as N,a6 as R,a7 as X,a8 as Y,a9 as B,aa as D,ab as G,ac as H,ad as L}from"./d3-core-BQA7b1Lo.js";import"./xlsx-lib-eYdzo_tC.js";function J({nodes:c=[],edges:p=[],width:e=600,height:r=400}){const x=v.useRef(null);return v.useEffect(()=>{const f=x.current;if(f.innerHTML="",!c.length)return;const d=q(f).append("svg").attr("width",e).attr("height",r),n=d.append("g"),$=N(R),E=X().scaleExtent([.5,2]).on("zoom",t=>{n.attr("transform",t.transform)});d.call(E);const s=c.map(t=>({...t})),y=p.map(t=>({...t})),o=Y(s).force("link",B(y).id(t=>t.id).distance(80).strength(.4)).force("charge",D().strength(-90)).force("collide",G().radius(t=>14+Math.log((t.value||1)*40))).force("center",H(e/2,r/2)).velocityDecay(.3),z=n.append("g").attr("stroke","#999").attr("stroke-opacity",.5).selectAll("line").data(y).enter().append("line").attr("stroke-width",t=>.5+Math.min(4,Math.sqrt(t.value||1))),u=n.append("g").selectAll("circle").data(s).enter().append("circle").attr("r",t=>6+Math.log((t.value||1)*40)).attr("fill",t=>$(t.id)).attr("stroke","#111").attr("stroke-width",.5).call(L().on("start",(t,a)=>{t.active||o.alphaTarget(.25).restart(),a.fx=a.x,a.fy=a.y}).on("drag",(t,a)=>{a.fx=t.x,a.fy=t.y}).on("end",(t,a)=>{t.active||o.alphaTarget(0),a.fx=null,a.fy=null}));u.append("title").text(t=>t.id);const T=n.append("g").selectAll("text").data(s).enter().append("text").text(t=>t.id).attr("font-size",10).attr("text-anchor","middle").attr("pointer-events","none").attr("fill","#fff"),g=(t,a,l)=>Math.max(a,Math.min(l,t));return o.on("tick",()=>{z.attr("x1",t=>t.source.x).attr("y1",t=>t.source.y).attr("x2",t=>t.target.x).attr("y2",t=>t.target.y),u.attr("cx",t=>t.x=g(t.x,20,e-20)).attr("cy",t=>t.y=g(t.y,20,r-20)),T.attr("x",t=>t.x).attr("y",t=>t.y-10)}),o.on("end",()=>{const t=s.map(m=>m.x),a=s.map(m=>m.y),l=Math.min(...t),M=Math.max(...t),k=Math.min(...a),h=Math.max(...a),i=Math.min(e/(M-l+80),r/(h-k+80),1.2),b=(e-(l+M)*i/2)/2,j=(r-(k+h)*i/2)/2;n.attr("transform",`translate(${b},${j}) scale(${i})`)}),()=>o.stop()},[c,p,e,r]),A.jsx("div",{ref:x})}export{J as default};
