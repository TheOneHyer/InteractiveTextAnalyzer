<!DOCTYPE html>
<html>
<head>
    <title>Network Graph Test</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body { margin: 20px; background: white; }
        #graph { border: 1px solid #ccc; }
    </style>
</head>
<body>
    <h2>Network Graph Test</h2>
    <div id="graph"></div>
    
    <script>
        const width = 800, height = 600;
        
        const nodes = [
            { id: 'apple', value: 10 },
            { id: 'banana', value: 8 },
            { id: 'orange', value: 12 },
            { id: 'grape', value: 6 },
            { id: 'mango', value: 9 }
        ];
        
        const edges = [
            { source: 'apple', target: 'banana', value: 2.5 },
            { source: 'apple', target: 'orange', value: 1.8 },
            { source: 'banana', target: 'grape', value: 3.2 },
            { source: 'orange', target: 'mango', value: 1.5 },
            { source: 'grape', target: 'mango', value: 2.8 }
        ];
        
        const el = document.getElementById('graph');
        const svg = d3.select(el).append('svg').attr('width', width).attr('height', height);
        const color = d3.scaleOrdinal(d3.schemeCategory10);

        const simulation = d3.forceSimulation(nodes)
            .force('link', d3.forceLink(edges).id(d=>d.id).distance(120))
            .force('charge', d3.forceManyBody().strength(-300))
            .force('center', d3.forceCenter(width/2, height/2))
            .force('collision', d3.forceCollide().radius(30));

        const link = svg.append('g').selectAll('line').data(edges).enter().append('line')
            .attr('stroke', '#999')
            .attr('stroke-opacity', 0.6)
            .attr('stroke-width', 1.5);

        const node = svg.append('g').selectAll('circle').data(nodes).enter().append('circle')
            .attr('r', d => 6 + Math.log(d.value || 1))
            .attr('fill', d => color(d.id));

        const labels = svg.append('g').selectAll('text').data(nodes).enter().append('text')
            .text(d=>d.id)
            .attr('font-size', 10)
            .attr('text-anchor','middle')
            .attr('fill','#1e293b')
            .attr('stroke', '#fff')
            .attr('stroke-width', 0.5)
            .attr('paint-order', 'stroke');

        simulation.on('tick', () => {
            link.attr('x1', d=>d.source.x).attr('y1', d=>d.source.y).attr('x2', d=>d.target.x).attr('y2', d=>d.target.y);
            node.attr('cx', d=>d.x).attr('cy', d=>d.y);
            labels.attr('x', d=>d.x).attr('y', d=>d.y - 10);
        });
    </script>
</body>
</html>
